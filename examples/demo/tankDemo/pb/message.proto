syntax = "proto3";

package pb;
//option go_package = "github.com/byebyebruce/lockstepserver/pb;pb";
option go_package = "./pb";


// æ¶ˆæ¯ID
enum ID {

  MSG_BEGIN = 0;

  MSG_Connect = 1;    //è¿æ¥(å®¢æˆ·ç«¯å‘æ¥ç¬¬ä¸€ä¸ªæ¶ˆæ¯)
  MSG_Heartbeat = 2;    //å¿ƒè·³(æœåŠ¡ç«¯è¿”å›ConnectæˆåŠŸä¹‹åæ¯éš”1ç§’å‘é€ä¸€ä¸ªå¿ƒè·³åŒ…)

  MSG_JoinRoom = 10;   // è¿›å…¥æˆ¿é—´
  MSG_CreateRoom = 11;   // åˆ›å»ºæˆ¿é—´
  MSG_RoomInfo = 12;   // æˆ¿é—´ä¿¡æ¯

  MSG_Progress = 20;   //è¿›åº¦

  MSG_Ready = 30;   //å‡†å¤‡
  MSG_Start = 40;   //å¼€å§‹

  MSG_Frame = 50;   //å¸§æ•°æ®
  MSG_Input = 60;   //è¾“å…¥

  MSG_Result = 70;   //ç»“æœ
  MSG_Close = 100;   //æˆ¿é—´å…³é—­
  MSG_END = 255;
}

// é”™è¯¯ç 
enum ERRORCODE {
  ERR_Ok = 0;    //OK
  ERR_NoPlayer = 1;    //æ²¡æœ‰è¿™ä¸ªç©å®¶
  ERR_NoRoom = 2;    //æ²¡æœ‰æˆ¿é—´
  ERR_RoomState = 3;    //æˆ¿é—´çŠ¶æ€ä¸æ­£ç¡®
  ERR_Token = 4;    //TokenéªŒè¯å¤±è´¥
}

// æˆ¿é—´ç±»å‹
enum ROOMTYPE {
  Room_Type_Default = 0;   // å•æœºæ¸¸æˆ
  Room_Type_One = 1;   // 1äººæ¸¸æˆ
  Room_Type_Two = 2 ;  // 2äººæ¸¸æˆ
}

//å®¢æˆ·ç«¯å‘æ¥çš„ç¬¬ä¸€ä¸ªæ¶ˆæ¯
message C2S_ConnectMsg  {
  optional uint64 playerID = 1;    // å”¯ä¸€ID
  optional string token = 10;      // ä»¤ç‰Œ
}

// åŠ å…¥æˆ¿é—´ -> S2C_JoinRoomMsg
message C2S_JoinRoomMsg  {
  optional uint64 roomId = 1;    // æˆ¿é—´å·
}

//æœåŠ¡ç«¯è¿”å›è¿æ¥ç»“æœ
message S2C_ConnectMsg  {
  optional ERRORCODE errorCode = 1;    //é”™è¯¯ç 
}

// åˆ›å»ºæˆ¿é—´ -> S2C_JoinRoomMsg
message C2S_CreateRoomMsg {
  optional uint64 roomId = 1; // æˆ¿é—´ id
  optional ROOMTYPE roomType = 2; // æˆ¿é—´ç±»å‹
}

// å¹¿æ’­ğŸ“¢ - æœåŠ¡ç«¯è¿”å›è¿›å…¥æˆ¿é—´æ¶ˆæ¯
message S2C_JoinRoomMsg  {
  optional int32 roomSeatId = 1;   //è‡ªå·±çš„ä½ç½®ç´¢å¼•id(1~N)
  repeated uint64 others = 2;   //å…¶ä»–äººçš„id
  repeated int32 pros = 3;   //å…¶ä»–äººçš„è¿›åº¦
  optional int32 randomSeed = 4;   //éšæœºç§å­
  optional ERRORCODE errorCode = 5;    //é”™è¯¯ç 
  optional uint64 ownerId = 6;   // æˆ¿ä¸»
}

// å¹¿æ’­ğŸ“¢ - æœåŠ¡ç«¯å¹¿æ’­æˆ¿é—´ä¿¡æ¯
message S2C_RoomInfoMsg  {
  optional uint64  roomId = 1;   // æˆ¿é—´ id
  optional uint64 ownerId = 2;   // æˆ¿ä¸»
  repeated uint64 others = 3;   //å…¶ä»–äººçš„id
  optional int32 randomSeed = 4;   //éšæœºç§å­
  optional ERRORCODE errorCode = 5;    //é”™è¯¯ç 
}

// å¹¿æ’­ğŸ“¢ - æœåŠ¡ç«¯å¹¿æ’­å¼€å§‹æ¸¸æˆæ¶ˆæ¯
message S2C_StartMsg  {
  optional int64 timeStamp = 1;   //åŒæ­¥æ—¶é—´æˆ³
}

// è¯»æ¡è¿›åº¦
message C2S_ProgressMsg  {
  optional int32 pro = 1;   //è¿›åº¦å€¼0~100
}

// è¯»æ¡è¿›åº¦
message S2C_ProgressMsg  {
  optional uint64 id = 1;   //id
  optional int32 pro = 2;   //è¿›åº¦å€¼0~100
}

// æ“ä½œè¾“å…¥æ¶ˆæ¯
message C2S_InputMsg  {
  optional uint32 frameID = 4;    //å¸§ID

  optional int32 sid = 1;    //æ“ä½œid
  optional float x = 2;    //æ“ä½œä½ç½®x
  optional float y = 3;    //æ“ä½œä½ç½®y
  optional float z = 5;
  optional float ex = 6;
  optional float ey = 7;
  optional float ez = 8;
  optional float turretY = 9;
  optional float gunX = 10;
  optional uint64 hp = 12;  // è¡€é‡
  optional uint64 damage = 13;  // ä¼¤å®³
}

// å¸§å­˜å‚¨æ“ä½œè¾“å…¥
message InputData {
  optional int32 sid = 1;    //æ“ä½œid
  optional float x = 2;    //æ“ä½œä½ç½®x
  optional float y = 3;    //æ“ä½œä½ç½®y
  optional float z = 5;
  optional float ex = 6;
  optional float ey = 7;
  optional float ez = 8;
  optional float turretY = 9;
  optional float gunX = 10;
  optional uint64 hp = 12;  // è¡€é‡
  optional uint64 damage = 13;  // ä¼¤å®³

  optional uint64 playerID = 21;    // ç©å®¶id
  optional int32 roomSeatId = 22;    //æ“ä½œè€…çš„ä½ç½®ç´¢å¼•id(1~N)
}

// å¸§æ•°æ®
message FrameData {
  optional uint32 frameID = 1;   // å¸§ID
  repeated InputData input = 2;   // æ“ä½œè¾“å…¥
}

// å¹¿æ’­ğŸ“¢ - å¹¿æ’­å¸§æ¶ˆæ¯
message S2C_FrameMsg {
  repeated FrameData frames = 1;   // å¸§æ•°æ®
}

// ç»“æœæ¶ˆæ¯
message C2S_ResultMsg {
  optional uint64 winnerID = 1; // èƒœåˆ©è€…ID
}

// å¹¿æ’­ğŸ“¢ - ç»“æœæ¶ˆæ¯
message S2C_ResultMsg {
  optional uint64 winnerID = 1; // èƒœåˆ©è€…ID
}

